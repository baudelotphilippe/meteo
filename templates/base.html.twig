<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="robots" content="noindex, nofollow"/>
		<title>La m√©t√©o locale sur Poitiers</title>

		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
		 <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
		 <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
		 <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.4.0/dist/chartjs-plugin-annotation.min.js"></script>

		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/weather-icons/2.0.10/css/weather-icons.min.css">

		<link rel="stylesheet" href="{{ asset('app.css') }}">

		<script>
			// Applique le th√®me imm√©diatement pour √©viter le flash
			(function() {
				const theme = localStorage.getItem('theme') || 'light';
				document.documentElement.setAttribute('data-theme', theme);
			})();
		</script>

		{% block javascripts %}{% endblock %}
	</head>
	<body>
		<button id="theme-toggle" class="theme-toggle" aria-label="Basculer le mode sombre">
			<span class="theme-toggle-icon">üåô</span>
		</button>

		{% block body %}{% endblock %}

		<script>
			// Gestion du dark mode
			const themeToggle = document.getElementById('theme-toggle');
			const themeIcon = themeToggle.querySelector('.theme-toggle-icon');

			function updateThemeIcon(theme) {
				themeIcon.textContent = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
			}

			// Initialisation
			const currentTheme = document.documentElement.getAttribute('data-theme');
			updateThemeIcon(currentTheme);

			// Toggle
			themeToggle.addEventListener('click', () => {
				const currentTheme = document.documentElement.getAttribute('data-theme');
				const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

				document.documentElement.setAttribute('data-theme', newTheme);
				localStorage.setItem('theme', newTheme);
				updateThemeIcon(newTheme);

				// Mettre √† jour les graphiques si la fonction existe
				if (typeof updateChartsTheme === 'function') {
					updateChartsTheme();
				}
			});
		</script>
	</body>
</html>
